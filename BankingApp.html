<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Simple Banking App (Demo)</title>
  <style>
    :root{--bg:#f4f7fb;--card:#ffffff;--muted:#6b7280;--accent:#0b79d0}
    *{box-sizing:border-box;font-family:Inter,ui-sans-serif,system-ui,Arial}
    body{margin:0;padding:24px;background:linear-gradient(180deg,var(--bg),#eef3fb);}
    .container{max-width:980px;margin:0 auto}
    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px}
    h1{margin:0;font-size:20px}
    .card{background:var(--card);border-radius:12px;padding:18px;box-shadow:0 6px 18px rgba(20,30,60,0.06)}
    .grid{display:grid;gap:12px}
    .cols-2{grid-template-columns:1fr 320px}
    label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
    input,select,button,textarea{width:100%;padding:10px;border-radius:8px;border:1px solid #e6eef8;background:#fff}
    .muted{color:var(--muted);font-size:13px}
    button{cursor:pointer;border:none;background:var(--accent);color:#fff;font-weight:600}
    .btn-ghost{background:transparent;border:1px solid #d8e8fb;color:var(--accent)}
    .nav{display:flex;gap:8px}
    .account{display:flex;justify-content:space-between;align-items:center;padding:12px;border-radius:8px;border:1px dashed #eef6ff}
    .tx{border-bottom:1px solid #f1f6fb;padding:10px 0;display:flex;justify-content:space-between}
    .positive{color:green}
    .negative{color:#d9534f}
    .small{font-size:13px;color:#475569}
    .center{display:flex;align-items:center;gap:8px}
    .hidden{display:none}
    footer{margin-top:14px;text-align:center;color:#94a3b8;font-size:13px}
    .logo{display:flex;align-items:center;gap:8px}
    .logo-dot{width:12px;height:12px;background:var(--accent);border-radius:4px}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">
        <div class="logo-dot"></div>
        <h1>MyBank — Demo</h1>
      </div>
      <nav class="nav muted" id="nav">
        <span id="nav-user" class="muted">Not signed in</span>
      </nav>
    </header>

    <!-- AUTH / LOGIN CARD -->
    <div id="auth-area" class="card">
      <div id="auth-forms" class="grid">
        <div>
          <h3>Login</h3>
          <p class="muted">Use the demo account or create a new one.</p>
          <label for="login-email">Email</label>
          <input id="login-email" type="email" placeholder="you@example.com" />
          <label for="login-password">Password</label>
          <input id="login-password" type="password" placeholder="password" />
          <div style="margin-top:10px;display:flex;gap:8px">
            <button id="btn-login">Sign in</button>
            <button class="btn-ghost" id="btn-show-register">Register</button>
          </div>
        </div>
        <div id="register-panel" class="hidden">
          <h3>Create account</h3>
          <label for="reg-name">Full name</label>
          <input id="reg-name" placeholder="Asha Patel" />
          <label for="reg-email">Email</label>
          <input id="reg-email" type="email" placeholder="you@example.com" />
          <label for="reg-password">Password</label>
          <input id="reg-password" type="password" placeholder="min 6 chars" />
          <label for="reg-initial">Starting Balance (INR)</label>
          <input id="reg-initial" type="number" value="5000" />
          <div style="margin-top:10px;display:flex;gap:8px">
            <button id="btn-register">Create account</button>
            <button class="btn-ghost" id="btn-cancel-register">Cancel</button>
          </div>
        </div>
      </div>
    </div>

    <!-- DASHBOARD -->
    <div id="app-area" class="hidden">
      <div class="grid cols-2" style="margin-top:14px">
        <div>
          <div class="card" style="margin-bottom:12px">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
              <div>
                <div id="greeting" style="font-size:16px;font-weight:700">Hello, User</div>
                <div class="muted small">Welcome back — your account overview</div>
              </div>
              <div class="center">
                <div class="muted small">Available balance</div>
                <div style="font-weight:800;margin-left:8px;font-size:20px" id="balance">₹0.00</div>
              </div>
            </div>
            <div style="display:flex;gap:8px;margin-top:12px">
              <button id="btn-deposit">Deposit</button>
              <button id="btn-withdraw" class="btn-ghost">Withdraw</button>
              <button id="btn-logout" class="btn-ghost">Logout</button>
            </div>
          </div>

          <div class="card" style="margin-bottom:12px">
            <h4 style="margin-top:0">Transfer money</h4>
            <label for="to-email">To (recipient email)</label>
            <input id="to-email" placeholder="friend@example.com" />
            <label for="amount">Amount (INR)</label>
            <input id="amount" type="number" placeholder="1000" />
            <label for="note">Note (optional)</label>
            <input id="note" placeholder="For dinner" />
            <div style="display:flex;gap:8px;margin-top:10px">
              <button id="btn-transfer">Send</button>
              <button id="btn-simulate" class="btn-ghost">Simulate</button>
            </div>
            <p id="transfer-msg" class="muted small" style="margin-top:8px"></p>
          </div>

          <div class="card">
            <h4 style="margin-top:0">Transaction history</h4>
            <div id="tx-list" style="margin-top:8px">
              <!-- transactions injected here -->
            </div>
          </div>

        </div>

        <aside>
          <div class="card">
            <h4 style="margin-top:0">Accounts</h4>
            <div id="accounts-list" style="margin-top:8px">
              <!-- accounts -> one card per account -->
            </div>
            <hr style="margin:12px 0;border:none;border-top:1px dashed #edf6ff" />
            <h5 style="margin-bottom:8px">Quick actions</h5>
            <div style="display:flex;flex-direction:column;gap:8px">
              <button id="btn-report" class="btn-ghost">Generate mini statement</button>
              <button id="btn-export">Export transactions (CSV)</button>
            </div>
          </div>
        </aside>
      </div>

      <footer>
        This is a local demo. Data is stored in your browser only (localStorage).
      </footer>
    </div>
  </div>

  <script>
    // Simple browser-only demo banking app
    // Data model in localStorage:
    // users: { email -> {name, email, password, balance, tx: [ {id,ts,type,amount,to,from,note} ] } }

    const demoEmail = 'demo@bank.test';
    const demoPassword = 'demo123';

    function uid(){return 't'+Math.random().toString(36).slice(2,10)}
    function now(){return new Date().toISOString()}

    // persistence helpers
    function loadUsers(){return JSON.parse(localStorage.getItem('bank_users')||'{}')}
    function saveUsers(u){localStorage.setItem('bank_users',JSON.stringify(u))}

    // bootstrap demo user if none
    (function initDemo(){
      const users = loadUsers();
      if(!users[demoEmail]){
        users[demoEmail] = {name:'Demo User',email:demoEmail,password:demoPassword,balance:10000,tx:[
          {id:uid(),ts:now(),type:'credit',amount:10000,from:'bank',to:demoEmail,note:'Initial demo credit'}
        ]};
        saveUsers(users);
      }
    })();

    // UI refs
    const authArea = document.getElementById('auth-area');
    const appArea = document.getElementById('app-area');
    const registerPanel = document.getElementById('register-panel');
    const navUser = document.getElementById('nav-user');

    let currentUser = null;

    // auth UI
    document.getElementById('btn-show-register').addEventListener('click',()=>{
      registerPanel.classList.remove('hidden');
    });
    document.getElementById('btn-cancel-register').addEventListener('click',()=>{
      registerPanel.classList.add('hidden');
    });

    document.getElementById('btn-register').addEventListener('click',()=>{
      const name = document.getElementById('reg-name').value.trim();
      const email = document.getElementById('reg-email').value.trim().toLowerCase();
      const password = document.getElementById('reg-password').value;
      const initial = parseFloat(document.getElementById('reg-initial').value||0);
      if(!name || !email || !password){alert('Please fill name, email, password');return}
      const users = loadUsers();
      if(users[email]){alert('Account with this email exists. Please log in.');return}
      users[email] = {name,email,password,balance:initial||0,tx:[]};
      if(initial>0){users[email].tx.push({id:uid(),ts:now(),type:'credit',amount:initial,from:'self',to:email,note:'Initial deposit'})}
      saveUsers(users);
      alert('Account created. You can now sign in.');
      registerPanel.classList.add('hidden');
      // optionally auto-fill login
      document.getElementById('login-email').value=email;
    });

    document.getElementById('btn-login').addEventListener('click',()=>{
      const email = document.getElementById('login-email').value.trim().toLowerCase();
      const password = document.getElementById('login-password').value;
      const users = loadUsers();
      if(!users[email] || users[email].password !== password){alert('Invalid credentials. Use demo@bank.test / demo123 or register.');return}
      currentUser = users[email];
      localStorage.setItem('bank_current',email);
      showApp();
    });

    // check if already logged in
    (function tryResume(){
      const cur = localStorage.getItem('bank_current');
      if(cur){const users=loadUsers(); if(users[cur]){currentUser=users[cur]; showApp()}}
    })();

    function showApp(){
      authArea.classList.add('hidden');
      appArea.classList.remove('hidden');
      navUser.textContent = currentUser.name + ' ('+currentUser.email+')';
      document.getElementById('greeting').textContent = 'Hello, '+currentUser.name.split(' ')[0];
      renderBalance();
      renderTx();
      renderAccountsList();
    }

    function renderBalance(){
      const b = Number(currentUser.balance||0).toFixed(2);
      document.getElementById('balance').textContent = '₹' + b;
    }

    function renderTx(){
      const list = document.getElementById('tx-list');
      list.innerHTML='';
      const tx = (currentUser.tx||[]).slice().reverse();
      if(tx.length===0){list.innerHTML='<div class="muted">No transactions yet</div>';return}
      tx.forEach(t=>{
        const div = document.createElement('div'); div.className='tx';
        const left = document.createElement('div');
        left.innerHTML = '<div style="font-weight:700">'+(t.type==='debit'?('To: '+t.to):('From: '+(t.from||'—')))+'</div><div class="muted small">'+(t.note||'')+'</div>';
        const right = document.createElement('div');
        right.innerHTML = '<div style="text-align:right"><div class="'+(t.type==='credit'?'positive':'negative')+'">'+(t.type==='credit'?'+':'-')+'₹'+Number(t.amount).toFixed(2)+"</div><div class='muted small'>"+new Date(t.ts).toLocaleString()+"</div></div>";
        div.appendChild(left);div.appendChild(right);
        list.appendChild(div);
      })
    }

    function renderAccountsList(){
      const el = document.getElementById('accounts-list'); el.innerHTML='';
      const a = document.createElement('div'); a.className='account';
      a.innerHTML = '<div><div style="font-weight:700">Primary — Current</div><div class="muted small">'+currentUser.email+'</div></div><div style="text-align:right"><div style="font-weight:800">₹'+Number(currentUser.balance||0).toFixed(2)+'</div></div>';
      el.appendChild(a);
    }

    // transfer
    document.getElementById('btn-transfer').addEventListener('click',()=>doTransfer(false));
    document.getElementById('btn-simulate').addEventListener('click',()=>doTransfer(true));

    function doTransfer(simulate){
      const to = document.getElementById('to-email').value.trim().toLowerCase();
      const amt = parseFloat(document.getElementById('amount').value||0);
      const note = document.getElementById('note').value;
      const msg = document.getElementById('transfer-msg'); msg.textContent='';
      if(!to || !amt || amt<=0){msg.textContent='Enter a valid recipient and amount';return}
      if(to === currentUser.email){msg.textContent='Cannot transfer to self';return}
      const users = loadUsers();
      if(!users[to]){msg.textContent='Recipient not found in demo store (this is local demo). To test, create the recipient account first.';return}
      if(currentUser.balance < amt){msg.textContent='Insufficient balance';return}
      if(simulate){msg.textContent='Simulation: transfer would succeed (no changes made).';return}
      // perform transfer
      users[currentUser.email].balance -= amt;
      users[to].balance = (users[to].balance||0) + amt;
      const txOut = {id:uid(),ts:now(),type:'debit',amount:amt,from:currentUser.email,to, note};
      const txIn = {id:uid(),ts:now(),type:'credit',amount:amt,from:currentUser.email,to, note};
      users[currentUser.email].tx = users[currentUser.email].tx || []; users[currentUser.email].tx.push(txOut);
      users[to].tx = users[to].tx || []; users[to].tx.push(txIn);
      saveUsers(users);
      // refresh current user from storage
      currentUser = users[currentUser.email];
      localStorage.setItem('bank_current',currentUser.email);
      renderBalance(); renderTx(); renderAccountsList();
      msg.textContent = 'Transfer complete — ₹'+amt.toFixed(2)+' sent to '+to;
      // clear fields
      document.getElementById('to-email').value=''; document.getElementById('amount').value=''; document.getElementById('note').value='';
    }

    // deposit / withdraw (local demo only)
    document.getElementById('btn-deposit').addEventListener('click',()=>{
      const v = prompt('Enter deposit amount (INR)', '1000');
      const amt = parseFloat(v||0); if(!amt || amt<=0)return alert('Invalid amount');
      const users = loadUsers(); users[currentUser.email].balance = (users[currentUser.email].balance||0)+amt;
      users[currentUser.email].tx.push({id:uid(),ts:now(),type:'credit',amount:amt,from:'cash',to:currentUser.email,note:'Deposit'});
      saveUsers(users); currentUser = users[currentUser.email]; renderBalance(); renderTx(); renderAccountsList();
      alert('Deposit successful');
    });
    document.getElementById('btn-withdraw').addEventListener('click',()=>{
      const v = prompt('Enter withdraw amount (INR)', '500');
      const amt = parseFloat(v||0); if(!amt || amt<=0)return alert('Invalid amount');
      if(currentUser.balance < amt) return alert('Insufficient balance');
      const users = loadUsers(); users[currentUser.email].balance -= amt;
      users[currentUser.email].tx.push({id:uid(),ts:now(),type:'debit',amount:amt,from:currentUser.email,to:'cash',note:'Withdraw'});
      saveUsers(users); currentUser = users[currentUser.email]; renderBalance(); renderTx(); renderAccountsList();
      alert('Withdrawn ₹'+amt.toFixed(2));
    });

    // logout
    document.getElementById('btn-logout').addEventListener('click',()=>{
      localStorage.removeItem('bank_current'); currentUser = null; appArea.classList.add('hidden'); authArea.classList.remove('hidden'); navUser.textContent='Not signed in';
    });

    // export CSV
    document.getElementById('btn-export').addEventListener('click',()=>{
      const rows = [['id','timestamp','type','amount','from','to','note']];
      (currentUser.tx||[]).forEach(t=>rows.push([t.id,t.ts,t.type,t.amount,t.from,t.to,(t.note||'')]));
      const csv = rows.map(r=>r.map(c=> '"'+String(c).replace(/"/g,'""')+'"').join(',')).join('\n');
      const blob = new Blob([csv],{type:'text/csv'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href=url; a.download='transactions_'+currentUser.email.replace(/@/g,'_')+'.csv'; a.click(); URL.revokeObjectURL(url);
    });

    // mini statement report (simple)
    document.getElementById('btn-report').addEventListener('click',()=>{
      const recent = (currentUser.tx||[]).slice(-5).map(t=>`${new Date(t.ts).toLocaleString()} | ${t.type.toUpperCase()} | ₹${Number(t.amount).toFixed(2)} | ${t.note||''}`).reverse().join('\n');
      alert('Mini statement (last 5):\n\n'+(recent||'No transactions yet'));
    });

    // small UX: allow pressing Enter to login
    document.getElementById('login-password').addEventListener('keydown',e=>{if(e.key==='Enter')document.getElementById('btn-login').click()});

  </script>
</body>
</html>
